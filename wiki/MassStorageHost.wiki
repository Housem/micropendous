#summary Mass Storage USB Device Host

The latest version of this firmware is available in the latest [http://code.google.com/p/micropendous/downloads/list Micropendous Distribution] or via [http://code.google.com/p/micropendous/source/checkout SVN] in the `/Micropendous/Firmware/USBtoSerial` directory.

*Purpose:* Host [http://en.wikipedia.org/wiki/USB_flash_drive USB Flash drives].  This demo is slightly modified from the LUFA version.  Only minor alterations were needed to [http://code.google.com/p/micropendous/source/diff?spec=svn758&r=758&format=side&path=/trunk/Micropendous/Firmware/MassStorageHost/MassStorageHost.c MassStorageHost.c], and [http://code.google.com/p/micropendous/source/diff?spec=svn758&r=758&format=side&path=/trunk/Micropendous/Firmware/MassStorageHost/MassStorageHost.h MassStorageHost.h], and the [http://code.google.com/p/micropendous/source/diff?spec=svn758&r=758&format=side&path=/trunk/Micropendous/Firmware/MassStorageHost/makefile makefile] for compatibility with Micropendous boards.  In the `makefile` you really only need to change `BOARD = MICROPENDOUS_REV2` and `F_CPU = 16000000`.

*Source Code:* [http://code.google.com/p/micropendous/source/browse/trunk/Micropendous/Firmware/MassStorageHost/  View] or [http://www.Micropendous.org/Distribution Download]

*Targets*: AT90USB1287 or AT90USB647 based hardware with hosting capability.

*USB Mode:* Host-mode

*Status*: _Working_

== Usage ==

Compile and load MassStorageHost firmware onto your USB AVR by following the [ProgramAndTest] tutorial.

Plug in a 2 gigabyte or smaller USB Flash drive (the demo won't work with larger flash drives).  To view debug messages, connect a USBtoSerial [http://code.google.com/p/micropendous/wiki/USBtoSerial USBtoSerial] device as follows:

|| *Micropendous*     || *UART Terminal* ||
|| *0* / PD2 _(RX)_   || TXD ||
|| *1* / PD3 _(TX)_   || RXD ||
|| GND                || GND ||

If using the Micropendous version of [USBtoSerial] with flow control you will also need to add Null Modem connections: (*4*)/PD1(RTS)=(*2*)/PD4(CTS), and (*5*)/PD0(DTR)=(*3*)/PD5(DSR)=(*6*)/PD6(DCD).

http://micropendous.googlecode.com/svn/trunk/Micropendous/Firmware/USBtoSerial/USBtoSerial_NullModem_with_Loopback.jpg

http://micropendous.googlecode.com/svn/trunk/Micropendous/Firmware/MassStorageHost/MassStorageHost-Micropendous_with_UART_Debug.jpg

With a Serial Terminal connected (9600 baud) you will see the following debug messages.  Refer to the [http://code.google.com/p/micropendous/wiki/Serial Serial] instructions for more information on setting up a Serial Terminal.

http://micropendous.googlecode.com/svn/trunk/Micropendous/Firmware/MassStorageHost/MassStorageHost-PuTTY_Debug_Session.jpg